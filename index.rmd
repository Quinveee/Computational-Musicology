---
title: "Analysis of my Personal Spotify Library"
author: "Quinten van Engelen"
date: "2024-02-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(tidyverse)
library(spotifyr)
```

```{r}
corpus <- get_playlist_audio_features("", "75LhP6wXfee0eYHuW28nkw")
corpus |>
  summarise(
    mean_speechiness = mean(speechiness),
    mean_acousticness = mean(acousticness),
    mean_liveness = mean(liveness),
    sd_speechiness = sd(speechiness),
    sd_acousticness = sd(acousticness),
    sd_liveness = sd(liveness),
    median_speechiness = median(speechiness),
    median_acousticness = median(acousticness),
    median_liveness = median(liveness),
    mad_speechiness = mad(speechiness),
    mad_acousticness = mad(acousticness),
    mad_liveness = mad(liveness)
  )
```

## Plots

```{r}
energy_plot <- ggplot(corpus, aes(x = liveness, acousticness, color = speechiness, size = speechiness)) + 
  geom_point() + 
  geom_jitter(alpha = 0.5, width = 0.1) +
  theme_classic() + 
  scale_color_viridis_c() + 
  guides(size = "none") +
  labs(x = "Acousticness",
       y = "Liveness",
       title = "Comparison of Liveness, Acousticness and Speechness",
       subtitle = "The plot consists of the liveness, acousticness and speechness of all individual songs")

print(energy_plot)
```

```{r}
#artists <- corpus %>%
#  dplyr::pull(track.artists) %>% .[c(1, 2)]
#
#print(artists[2])
#artists <- corpus['track.artists'][[1]]
#print(artists[names(artists) %in% c("tricot")])
library(tidytext)

corpus_energy <- corpus %>% 
  group_by(track.album.name) %>%
  summarize(album_energy=mean(energy))

global_mean <- mean(corpus$energy)

ggplot(corpus_energy, aes(x = album_energy, y = reorder(track.album.name, album_energy), color = album_energy)) +
  geom_point(size = 4) +
  geom_vline(xintercept = global_mean, color = "grey40", linetype = 3) +
  geom_segment(aes(xend = 0, yend = track.album.name), size = 2) + 
  theme_classic() +
  theme(legend.position = 'none') +
  labs(x = "Album's Mean Energy",
       y = "Album",
       title = "Albums ranked on their mean energy level") + 
  annotate(
    "text",
    x = global_mean + 0.06, y = 8,
    label = "Global\nmean",
    vjust = 1, size = 3, color = "grey40"
  ) 

```
